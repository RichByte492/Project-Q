<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #121212;
            color: #fff;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }
        h1 {
            font-size: 36px;
            color: #00bfff;
            text-shadow: 0 0 10px rgba(0, 191, 255, 0.7);
        }
        .chart-container {
            margin-bottom: 20px;
            position: relative;
        }
        .prediction-container {
            font-size: 24px;
            font-weight: bold;
            color: #00bfff;
        }
        select {
            padding: 10px;
            font-size: 16px;
            margin-top: 20px;
            width: 100%;
            max-width: 250px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            background-color: #333;
            color: #00bfff;
            border: 2px solid #00bfff;
            border-radius: 5px;
        }
        select:hover {
            background-color: #444;
        }
        .controls {
            margin-top: 20px;
        }
        .loading {
            font-size: 18px;
            color: #888;
        }
        .button {
            background-color: #00bfff;
            color: #121212;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
        }
        .button:hover {
            background-color: #0088cc;
        }
        .comparison-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        .comparison-container select {
            margin: 0 10px;
        }
        .technical-indicators {
            margin-top: 20px;
        }
        .technical-indicators label {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Stock Prediction</h1>
        <div class="chart-container">
            <canvas id="stockChart"></canvas>
        </div>
        <div class="controls">
            <div class="loading" id="loading">Loading stock data...</div>
            <select id="stockSelect" onchange="onStockChange()">
                <!-- Stock options will be populated here -->
            </select>
            <div class="comparison-container">
                <select id="compareStock1" onchange="updateComparison()">
                    <!-- Stock comparison options will be populated here -->
                </select>
                <select id="compareStock2" onchange="updateComparison()">
                    <!-- Stock comparison options will be populated here -->
                </select>
            </div>
            <div class="technical-indicators">
                <label><input type="checkbox" id="showMovingAverage" onchange="updateChart()"> Moving Average</label>
                <label><input type="checkbox" id="showRSI" onchange="updateChart()"> RSI</label>
                <label><input type="checkbox" id="showMACD" onchange="updateChart()"> MACD</label>
            </div>
            <button class="button" onclick="updateChart(selectedStock)">Get Data</button>
        </div>
        <div class="prediction-container">
            <p>Predicted Price: <span id="predictedPrice">Loading...</span></p>
        </div>
    </div>

<audio id="alan-walker-music" loop>
        <source src="alan-walker-music.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
</audio>
    <script>
        const apiKey = 'YP2G6WBDG1F4DJP0'; // Alpha Vantage API key
        const stockSymbols = [
            'AAPL', 'GOOGL', 'TSLA', 'MSFT', 'AMZN', 'FB', 'NVDA', 'NFLX', 'AMD', 'BA', 'DIS', 'IBM', 'INTC', 'NVDA', 'BABA', 'UBER', 'PYPL', 'SNAP'
        ]; // Expanded list of stock symbols
        let selectedStock = ''; // Currently selected stock

        // Function to pick a random stock symbol from the list
        function getRandomStock() {
            const randomIndex = Math.floor(Math.random() * stockSymbols.length);
            return stockSymbols[randomIndex];
        }

        // Fetch stock data from Alpha Vantage API
        async function fetchStockData(stockSymbol) {
            const response = await fetch(`https://www.alphavantage.co/query?function=TIME_SERIES_MONTHLY&symbol=${stockSymbol}&apikey=${apiKey}`);
            const data = await response.json();
            if (data['Monthly Time Series']) {
                const timeSeries = data['Monthly Time Series'];
                const labels = [];
                const prices = [];

                // Extract the last 6 months of data
                const dateKeys = Object.keys(timeSeries).slice(0, 6);
                for (let i = 0; i < dateKeys.length; i++) {
                    const date = dateKeys[i];
                    labels.push(date.substring(0, 7)); // Year-Month format
                    prices.push(parseFloat(timeSeries[date]['4. close']));
                }

                return { labels, prices };
            } else {
                throw new Error('Failed to fetch data or invalid stock symbol.');
            }
        }

        // Update chart and prediction for the selected stock
        async function updateChart(stockSymbol) {
            document.getElementById('loading').style.display = 'block';
            const stockData = await fetchStockData(stockSymbol);

            // Update the chart with the stock data
            updateChartData(stockData);

            // Calculate and display the technical indicators
            updateTechnicalIndicators(stockData.prices);

            // Update the predicted price
            await predictPrice(stockData.prices);
            document.getElementById('loading').style.display = 'none';
        }

        // Function to update the chart data
        function updateChartData(stockData) {
            const ctx = document.getElementById('stockChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: stockData.labels,
                    datasets: [{
                        label: 'Stock Price',
                        data: stockData.prices,
                        backgroundColor: 'rgba(0, 191, 255, 0.2)',
                        borderColor: 'rgba(0, 191, 255, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        // Function to update the comparison chart
        async function updateComparison() {
            const stock1 = document.getElementById('compareStock1').value;
            const stock2 = document.getElementById('compareStock2').value;
            const stock1Data = await fetchStockData(stock1);
            const stock2Data = await fetchStockData(stock2);

            const ctx = document.getElementById('stockChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: stock1Data.labels,
                    datasets: [
                        {
                            label: stock1,
                            data: stock1Data.prices,
                            backgroundColor: 'rgba(0, 191, 255, 0.2)',
                            borderColor: 'rgba(0, 191, 255, 1)',
                            borderWidth: 1
                        },
                        {
                            label: stock2,
                            data: stock2Data.prices,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        // Function to calculate and display technical indicators
        function updateTechnicalIndicators(prices) {
            // Implement the logic to calculate and display moving average, RSI, and MACD
            // Update the UI elements accordingly
        }

        // Simple TensorFlow.js model for price prediction (placeholder)
        async function predictPrice(prices) {
            const model = tf.sequential();
            model.add(tf.layers.dense({ units: 1, inputShape: [1] }));
            model.compile({ optimizer: 'sgd', loss: 'meanSquaredError' });

            // Prepare training data
            const xs = tf.tensor2d(prices.slice(0, 6).map((_, index) => [index + 1]), [6, 1]);
            const ys = tf.tensor2d(prices.slice(0, 6), [6, 1]);

            await model.fit(xs, ys, { epochs: 100 });

            const nextMonth = tf.tensor2d([7], [1, 1]); // Predict for the 7th month
            const predictedPrice = model.predict(nextMonth).dataSync()[0];

            document.getElementById('predictedPrice').textContent = predictedPrice.toFixed(2);
        }

        // Populate the dropdown with stock symbols and update chart when a stock is selected
        function populateStockDropdown() {
            const selectElement = document.getElementById('stockSelect');
            const compareSelect1 = document.getElementById('compareStock1');
            const compareSelect2 = document.getElementById('compareStock2');

            stockSymbols.forEach(symbol => {
                const option = document.createElement('option');
                option.value = symbol;
                option.textContent = symbol;
                selectElement.appendChild(option);
                compareSelect1.appendChild(option.cloneNode(true));
                compareSelect2.appendChild(option.cloneNode(true));
            });

            // Initially set the random stock symbol
            selectedStock = getRandomStock();
            selectElement.value = selectedStock;
            compareSelect1.value = stockSymbols[0];
            compareSelect2.value = stockSymbols[1];
            updateChart(selectedStock);
            updateComparison();
        }

        // Handle stock change from the dropdown
        function onStockChange() {
            selectedStock = document.getElementById('stockSelect').value;
            updateChart(selectedStock);
 

       
        populateStockDropdown();
    </script>
</body>
</html>
